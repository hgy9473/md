# vi 使用笔记

> 测试环境：Ubuntu 18.04

## 概述

> vi 是面向屏幕的文本编辑器，最初是为 Unix 操作系统创造的。

vi 有三种模式：

* 命令模式  
* 输入模式  
* 底行模式（有时候归到『命令模式』）  

##　命令模式和底行模式常用操作示例

> vi 打开的时候是命令模式

```c
// 终端窗口直接输入,可查看 vi 版本基本信息
$ vi

// 根据界面提示退出

// 打开文件 a.js
$ vi filename

// 打开文件 a.js，跳到末尾行
$ vi + a.js

// 打开文件 a.js，跳到第 n 行
$ vi +n a.js

// 打开文件 a.js ，跳到字符串 hgy 第一次出现的那一行
// 如果文件中有多个 hgy ,可按键盘 N ,实现在 hgy 之间跳转
$ vi +/hgy a.js

// 打开多个文件
$ vi aa bb cc
/* 跳到下一个文件: 输入:n，按 Enter
 * 跳到上一个文件: 输入:N,按 Enter
 */

// 保存并退出
:wq

// 不保存退出
:q

```

## 底行模式常用命令

* `:w` 写入硬盘
* `:q` 退出
* `:!` 强制执行
* `:n` 切换到后一个文件
* `:N` 切换到前一个文件
* `:15` 定位到 15 行
* `:/hgy` 定位到 hgy 第一次出现的行
* `:?hgy` 从当前光标向上查找 hgy

## 命令模式常用指令

* `h` 光标左移
* `j` 光标下移
* `k` 光标上移
* `l` 光标右移  

* `X` 向前删除一个字符
* `x` 向后删除一个字符

* `Ctrl + f` 向下翻页
* `Ctrl + b` 向上翻页
* `Ctrl + d` 向下翻半页
* `Ctrl + u` 向上翻半页

* `dd` 删除光标所在行
* `o` 在光标下方插入一行并进入输入模式
* `yy` 复制光标所在行到剪切板 
* `p` 粘贴内容到光标下方 
* `P` 粘贴内容到光标上方 
* ... 更多操作搜索『vi指令图』

## 输入模式使用方法

> 命令模式按 i 进入输入模式，输入模式按 Esc 进入命令模式。

命令模式时光标移动到要修改的位置后，用X/x删除字符或者进入输入模式，输入字符，按 Esc 进入命令模式，继续移动光标查看。

## 常用操作

* 文件之间复制粘贴

```c
// 打开两个文件，通过 n N 来切换文件 ，通过 :files 查看打开了哪些文件
$ vi a.js b.js

// 复制 a.js 最后 5 行：光标移到倒数第 5 行，按下 5yy
// 切换到 b.js， 移动光标到粘贴位置，按下 p

```

* 撤销、删除

```c

// 删除一个字符 : D
// 删除一行：dd

// 撤销 u

```

* 区块选择

```c
// 选择一个方形区域、复制： Ctrl + v，移动光标，y

// 选择光标经过的整行内容：V，移动光标，y

// 选择光标经过的行，第一行和最后一行不一定是整行：v, 移动光标，y

```

* 暂存功能

当出现异常导致文件没有保存好时，vi 会在文件所在目录建立 `<filename>`.swp 文件。当再次打开文件时，vi 会提示存在可恢复文件，可以选择是否恢复，当选择恢复时需要自己手动删掉暂存文件。




